<?php

namespace common\components;
 
use Yii;
use yii\base\Component;

use yii\db\Query;
$connection = \Yii::$app->db;
 
class forAppointment extends Component {
 
    public function generateCode()
    {
      $model = $connection->createCommand("SELECT CONCAT('VA', CAST(YEAR(NOW()) AS CHAR(15)),
                                                    '-', RIGHT( CONCAT('00000', MAX(id)+1 ) , 6)) AS appointment_code
                                                    FROM appointment");
        $appointment_code = $model->queryOne();

        return $appointment_code;
    }
}